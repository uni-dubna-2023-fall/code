# Домашка 5

## MapReduce
В свое время, когда компания Google столкнулась с необходимостью обработки больших массивов данных, ее инженеры придумали парадигму [MapReduce](https://ru.wikipedia.org/wiki/MapReduce). Смысл в том, чтобы разделить все данные на части и передать эти части нескольким обработчикам, а после собрать результаты обработки и сформировать окончательный результат вычислений.

Давайте попробуем сделать небольшую модель, реализующую эту парадигму. В качестве обработчиков мы будем использовать процессы операционной системы. В языке Python есть библиотека multiprocessing, которую можно использовать для этих целей. В качестве модельной задачи для параллельной обработки мы будем умножать две большие матрицы, например размером 100x100.

Чтобы упражнение было более содержательным давайте сделаем там, чтобы с этой вычислительной моделью можно было взаимодействовать по HTTP. То есть пользователь обращается в HTTP серверу, передает 2 матрицы при помощи POST запроса и через какое какое-то время получает результат при помощи GET запроса.

Пользователь должен иметь возможность передавать новую вычислительную задачу, не ожидая окончания результата предыдущей.

Зафиксируем следующий программный интерфейс

```python
class Manager:
    def __init__(self):
        pass

    def run(self):
        """Запустить работу вычислительной модели
        """
        pass

    def stop(self):
        """Остановить работу вычислительной модели
        """
        pass

    def add_task(self, matrix_a, matrix_b):
        """Передать две матрицы для перемножения и создать новую задачу
        """
        return task_id

    def status_task(self, task_id):
        """Возвращает статус вычислительной задачи 'running' или 'finished'
        """
        return 'running'

    def get_result(self, task_id):
        """Получить результат перемножения матриц, если вычисление закончено
        """
        return result

    def remove_task(self, task_id):
        """Удалить задачу после окончания вычислений
        """
        return task_id

    def list_tasks(self):
        """Вернуть список всех задач
        """
        return list_of_task_ids


@app.route('/multiply', methods=['POST'])
def multiply():
    """Этот HTTP обработчик должен принимать json строку вида
    {"matrix_a": [[1, 2], [3, 4]], "matrix_b": [[5, 6], [7, 8]]}
    и возвращать json строку вида
    {"task_id": "task_id", "status": "status"}
    """
    pass


@app.route('/status/<task_id>', methods=['GET'])
def status_task(task_id):
    """Этот HTTP обработчик должен возвращать json строку вида
    {"task_id": "task_id", "status": "status"}
    """
    pass


@app.route('/tasks', methods=['GET'])
def list_task():
    """Этот HTTP обработчик должен возвращать json строку вида
    ["task_id_1", "task_id_2"]
    """
    pass


@app.route('/result/<task_id>', methods=['GET'])
def get_result(task_id):
    """Этот HTTP обработчик должен возвращать json строку вида
    {"task_id": "task_id", "result": [[1, 2], [3, 4]]}
    """
    pass


@app.route('/remove/<task_id>', methods=['DELETE'])
def remove_task(task_id):
    """Этот HTTP обработчик должен возвращать json строку вида
    {"task_id": "task_id", "status": "ok"}
    """
    pass

```